define("easyhin/register/1.0.0/register",["jquery","easyhin/common/1.0.0/common.js"],function(a,b,c){function d(){function a(a){return b(c(k(a),a.length*o.chrsz))}function b(a){for(var b=o.hexcase?"0123456789ABCDEF":"0123456789abcdef",c="",d=0;d<4*a.length;d++)c+=b.charAt(a[d>>2]>>d%4*8+4&15)+b.charAt(a[d>>2]>>d%4*8&15);return c}function c(a,b){a[b>>5]|=128<<b%32,a[(b+64>>>9<<4)+14]=b;for(var c=1732584193,d=-271733879,j=-1732584194,k=271733878,l=0;l<a.length;l+=16){var m=c,n=d,o=j,p=k;c=e(c,d,j,k,a[l+0],7,-680876936),k=e(k,c,d,j,a[l+1],12,-389564586),j=e(j,k,c,d,a[l+2],17,606105819),d=e(d,j,k,c,a[l+3],22,-1044525330),c=e(c,d,j,k,a[l+4],7,-176418897),k=e(k,c,d,j,a[l+5],12,1200080426),j=e(j,k,c,d,a[l+6],17,-1473231341),d=e(d,j,k,c,a[l+7],22,-45705983),c=e(c,d,j,k,a[l+8],7,1770035416),k=e(k,c,d,j,a[l+9],12,-1958414417),j=e(j,k,c,d,a[l+10],17,-42063),d=e(d,j,k,c,a[l+11],22,-1990404162),c=e(c,d,j,k,a[l+12],7,1804603682),k=e(k,c,d,j,a[l+13],12,-40341101),j=e(j,k,c,d,a[l+14],17,-1502002290),d=e(d,j,k,c,a[l+15],22,1236535329),c=f(c,d,j,k,a[l+1],5,-165796510),k=f(k,c,d,j,a[l+6],9,-1069501632),j=f(j,k,c,d,a[l+11],14,643717713),d=f(d,j,k,c,a[l+0],20,-373897302),c=f(c,d,j,k,a[l+5],5,-701558691),k=f(k,c,d,j,a[l+10],9,38016083),j=f(j,k,c,d,a[l+15],14,-660478335),d=f(d,j,k,c,a[l+4],20,-405537848),c=f(c,d,j,k,a[l+9],5,568446438),k=f(k,c,d,j,a[l+14],9,-1019803690),j=f(j,k,c,d,a[l+3],14,-187363961),d=f(d,j,k,c,a[l+8],20,1163531501),c=f(c,d,j,k,a[l+13],5,-1444681467),k=f(k,c,d,j,a[l+2],9,-51403784),j=f(j,k,c,d,a[l+7],14,1735328473),d=f(d,j,k,c,a[l+12],20,-1926607734),c=g(c,d,j,k,a[l+5],4,-378558),k=g(k,c,d,j,a[l+8],11,-2022574463),j=g(j,k,c,d,a[l+11],16,1839030562),d=g(d,j,k,c,a[l+14],23,-35309556),c=g(c,d,j,k,a[l+1],4,-1530992060),k=g(k,c,d,j,a[l+4],11,1272893353),j=g(j,k,c,d,a[l+7],16,-155497632),d=g(d,j,k,c,a[l+10],23,-1094730640),c=g(c,d,j,k,a[l+13],4,681279174),k=g(k,c,d,j,a[l+0],11,-358537222),j=g(j,k,c,d,a[l+3],16,-722521979),d=g(d,j,k,c,a[l+6],23,76029189),c=g(c,d,j,k,a[l+9],4,-640364487),k=g(k,c,d,j,a[l+12],11,-421815835),j=g(j,k,c,d,a[l+15],16,530742520),d=g(d,j,k,c,a[l+2],23,-995338651),c=h(c,d,j,k,a[l+0],6,-198630844),k=h(k,c,d,j,a[l+7],10,1126891415),j=h(j,k,c,d,a[l+14],15,-1416354905),d=h(d,j,k,c,a[l+5],21,-57434055),c=h(c,d,j,k,a[l+12],6,1700485571),k=h(k,c,d,j,a[l+3],10,-1894986606),j=h(j,k,c,d,a[l+10],15,-1051523),d=h(d,j,k,c,a[l+1],21,-2054922799),c=h(c,d,j,k,a[l+8],6,1873313359),k=h(k,c,d,j,a[l+15],10,-30611744),j=h(j,k,c,d,a[l+6],15,-1560198380),d=h(d,j,k,c,a[l+13],21,1309151649),c=h(c,d,j,k,a[l+4],6,-145523070),k=h(k,c,d,j,a[l+11],10,-1120210379),j=h(j,k,c,d,a[l+2],15,718787259),d=h(d,j,k,c,a[l+9],21,-343485551),c=i(c,m),d=i(d,n),j=i(j,o),k=i(k,p)}return Array(c,d,j,k)}function d(a,b,c,d,e,f){return i(j(i(i(b,a),i(d,f)),e),c)}function e(a,b,c,e,f,g,h){return d(b&c|~b&e,a,b,f,g,h)}function f(a,b,c,e,f,g,h){return d(b&e|c&~e,a,b,f,g,h)}function g(a,b,c,e,f,g,h){return d(b^c^e,a,b,f,g,h)}function h(a,b,c,e,f,g,h){return d(c^(b|~e),a,b,f,g,h)}function i(a,b){var c=(65535&a)+(65535&b),d=(a>>16)+(b>>16)+(c>>16);return d<<16|65535&c}function j(a,b){return a<<b|a>>>32-b}function k(a){for(var b=Array(),c=(1<<o.chrsz)-1,d=0;d<a.length*o.chrsz;d+=o.chrsz)b[d>>5]|=(a.charCodeAt(d/o.chrsz)&c)<<d%32;return b}var l=0,m="",n=8,o={};return o.hexcase=l,o.b64pad=m,o.chrsz=n,o.hex_md5=a,o.binl2hex=b,o.core_md5=c,o}var e=a("jquery"),f=a("easyhin/common/1.0.0/common.js"),g=f.getQS;c.exports={init:function(a){"reg"==a?h.init():j.init()}};var h={text:["请输入您的常用邮箱","请输入您的密码，至少6个字符","请输入您的昵称","请输入验证码"],init:function(){this.bindEvent(),this.refresh()},bindEvent:function(){var a=this,b=e("#username");b.blur(function(){""==e.trim(e(this).val())?(e(this).next().html(a.text[0]),a.showTips(this,"error","电子邮箱不能为空")):a.verifyMail(e(this).val())?(e(this).css({borderColor:"#7abd54"}),a.showTips(this,"ok","")):a.showTips(this,"error","电子邮箱格式错误，如abc@qq.com")}).focus(function(){e(this).removeAttr("style").next().html("").parent().next().attr("class","tips msg").html("请输入正确的邮箱，可用于找回密码")}).keyup(function(b){var c=b.keyCode?b.keyCode:b.which;(13==c||10==c)&&a.set()});var c=e("#passwd");c.blur(function(){""==e(this).val()?(e(this).next().html(a.text[1]),a.showTips(this,"error","密码不能为空")):e(this).val().length<6?a.showTips(this,"error","密码长度不能小于6位"):(e(this).css({borderColor:"#7abd54"}),a.showTips(this,"ok",""),a.showPwdTips(this))}).focus(function(){e(this).removeAttr("style").next().html("").parent().next().attr("class","tips msg").html("请输入密码，长度为6-16个字符")}).keyup(function(b){var c=b.keyCode?b.keyCode:b.which;(13==c||10==c)&&a.set(),""==e(this).val()?a.showTips(this,"error","密码不能为空"):e(this).val().length<6?a.showTips(this,"error","密码长度不能小于6位"):(e(this).css({borderColor:"#7abd54"}),a.showTips(this,"ok",""),a.showPwdTips(this))});var d=e("#cpasswd");d.blur(function(){""==e(this).val()?(e(this).next().html(a.text[1]),a.showTips(this,"error","密码不能为空")):e(this).val()!=e(c).val()?a.showTips(this,"error","密码不一致"):(e(this).css({borderColor:"#7abd54"}),a.showTips(this,"ok",""))}).focus(function(){e(this).removeAttr("style").next().html("").parent().next().attr("class","tips msg").html("请再次输入密码")}).keyup(function(b){var d=b.keyCode?b.keyCode:b.which;(13==d||10==d)&&a.set(),""==e(this).val()?a.showTips(this,"error","密码不能为空"):e(this).val()!=e(c).val()?a.showTips(this,"error","密码不一致"):(e(this).css({borderColor:"#7abd54"}),a.showTips(this,"ok",""))});var f=e("#nickname");f.blur(function(){""==e.trim(e(this).val())?(e(this).next().html(a.text[2]),a.showTips(this,"error","昵称不能为空")):(e(this).css({borderColor:"#7abd54"}),a.showTips(this,"ok",""))}).focus(function(){e(this).removeAttr("style").next().html("").parent().next().attr("class","tips msg").html("请输入昵称")}).keyup(function(b){var c=b.keyCode?b.keyCode:b.which;(13==c||10==c)&&a.set()});var g=e("#vcode");g.blur(function(){""==e.trim(e(this).val())?e(this).next().html(a.text[3]):4!=e.trim(e(this).val()).length||e(this).css({borderColor:"#7abd54"})}).focus(function(){e(this).removeAttr("style").next().html("")}).keyup(function(b){var c=b.keyCode?b.keyCode:b.which;(13==c||10==c)&&a.set()}),e("#verify-refresh,#vcode-img").click(function(){return a.refresh(),!1}),e("#submitbtn").click(function(){return a.set(),!1}),e("#protocol").click(function(){this.checked?e("#submitbtn").removeClass("disabled").click(function(){return a.set(),!1}):e("#submitbtn").addClass("disabled").unbind()})},refresh:function(){e("#vcode-img").attr("src","/index.php?c=vcode&r="+Math.random()),e("#vcode").val("")},set:function(){if(!this.verifyFields())return!1;var a=this,b=e("#username").val(),c=d(),f=e("#passwd").val();f=c.hex_md5(c.hex_md5(c.hex_md5(f))).toUpperCase(),e.ajax({url:"/index.php?c=register&m=reg",data:{username:b,password:f,nickname:e("#nickname").val(),vcode:e("#vcode").val()},type:"post",dataType:"json",cache:"false",beforeSend:function(){e("#submitbtn").html("<span>注册中</span>")},error:function(){alert("系统繁忙，请稍后重试"),e("#submitbtn").html("<span>立即注册</span>")},success:function(b){switch(e("#submitbtn").html("<span>立即注册</span>"),1*b.retCode){case 0:window.location="/index.php?c=register&m=result";break;case 4:a.refresh(),alert(b.retMsg);break;default:a.refresh(),alert(b.retMsg)}}})},verifyMail:function(a){return/^([a-z0-9\+_\-]+)(\.[a-z0-9\+_\-]+)*@([a-z0-9\-]+\.)+[a-z]{2,6}$/gi.test(a)?!0:!1},verifyFields:function(){var a=!0,b=e("#username");""==e.trim(b.val())?(b.next().html(this.text[0]),this.showTips(b,"error","电子邮箱不能为空"),a=!1):this.verifyMail(b.val())||(this.showTips(b,"error","电子邮箱格式错误，如abc@qq.com"),a=!1);var c=e("#passwd");""==c.val()?(c.next().html(this.text[1]),this.showTips(c,"error","密码不能为空"),a=!1):e.trim(c.val()).length<6&&(this.showTips(c,"error","密码长度不能小于6位"),a=!1);var d=e("#cpasswd");""==d.val()?(d.next().html(this.text[1]),this.showTips(d,"error","密码不能为空"),a=!1):d.val()!=c.val()&&(this.showTips(d,"error","密码不一致"),a=!1);var f=e("#nickname");""==f.val()&&(f.next().html(this.text[2]),this.showTips(f,"error","昵称不能为空"),a=!1);var g=e("#vcode");return""==e.trim(g.val())?(g.next().html(this.text[3]),a=!1):4!=e.trim(g.val()).length&&(a=!1),a},sendActivateMail:function(){return""==e("#username").val()?!1:(e.ajax({url:"/index.php?c=register&m=sendActivateMail",data:{username:e("#username").val()},type:"post",dataType:"json",cache:"false",beforeSend:function(){},error:function(){alert("系统繁忙，请稍后重试")},success:function(a){switch(1*a.retCode){case 0:alert(a.retMsg);break;default:alert(a.retMsg)}}}),void 0)},showTips:function(a,b,c){e(a).parent().next().attr("class","tips "+b).html(c)},showPwdTips:function(a){var b=this.checkStrong(e(a).val());0==b?this.showTips(a,"error","密码长度不能小于6位"):(b-=1,e("#pwdstrength-tips").css("visibility","visible"),e("#pwdstrength").attr("class",["rankLow","rankMiddle","rankMiddle","rankHigh"][b]))},charMode:function(a){return a>=48&&57>=a?1:a>=65&&90>=a?2:a>=97&&122>=a?4:8},bitTotal:function(a){for(var b=0,c=0;4>c;c++)1&a&&b++,a>>>=1;return b},checkStrong:function(a){if(a.length<6)return 0;var b=0;for(i=0;i<a.length;i++)b|=this.charMode(a.charCodeAt(i));return this.bitTotal(b)}},j={mailList:{"qq.com":"mail.qq.com","foxmail.com":"mail.foxmail.com","vip.qq.com":"mail.qq.com","163.com":"mail.163.com","126.com":"www.126.com","yeah.net":"yeah.net","vip.126.com":"vip.126.com","vip.163.com":"vip.163.com","188.com":"mail.188.com","x263.net":"mail.263.net","263.net":"mail.263.net","263.net.cn":"mail.263.net","wo.com.cn":"mail.wo.com.cn","189.cn":"mail.189.cn","139.com":"mail.10086.cn","sohu.com":"mail.sohu.com","eyou.com":"www.eyou.com","sogou.com":"mail.sogou.com","21cn.com":"mail.21cn.com","tom.com":"mail.tom.com","vip.sina.com":"vip.sina.com.cn","sina.com.cn":"mail.sina.com.cn","hotmail.com":"mail.hotmail.com",outlook:"www.outlook.com","live.cn":"www.live.cn","live.com":"www.live.com","yahoo.com.cn":"mail.cn.yahoo.com","yahoo.com":"mail.yahoo.com","ymail.com":"www.ymail.com","rocketmail.com":"www.rocketmail.com"},text:["请输入您的常用邮箱","请输入您的密码，至少6个字符","请输入您的昵称","请输入验证码"],init:function(){this.bindEvent()},bindEvent:function(){var a=this;e("#sendActivateMailBtn").click(function(){return a.sendActivateMail(),!1}),e("#toMailHomePageBtn").click(function(){var b=g("un"),c=b.split("@")[1];return window.open("http://"+(a.mailList[c]?a.mailList[c]:"mail."+c)),!1})},sendActivateMail:function(){var a=g("un");return""==a?!1:(e.ajax({url:"/index.php?c=register&m=sendActivateMail",data:{username:a},type:"post",dataType:"json",cache:"false",beforeSend:function(){},error:function(){alert("系统繁忙，请稍后重试")},success:function(a){switch(1*a.retCode){case 0:alert(a.retMsg);break;default:alert(a.retMsg)}}}),void 0)}}});
